<!DOCTYPE html>
<html>
<head>
  <title>Barkod Okuyucu</title>
  <script src="https://unpkg.com/html5-qrcode"></script>
  <style>
    #productList li {
      margin: 5px 0;
    }
  </style>
</head>
<body>
  <h2>Barkod Okuyucu</h2>
  <div id="reader" style="width: 300px;"></div>
  <p><strong>Barkod:</strong> <span id="result"></span></p>

  <input type="text" id="searchBox" placeholder="Ürün ara...">

  <ul id="productList">
    <li data-barcode="8681749651252">Ürün A - Barkod: 8681749651252</li>
    <li data-barcode="6931534500145">Ürün B - Barkod: 6931534500145</li>
  </ul>

  <script>
    function filterProducts(searchTerm) {
      searchTerm = searchTerm.trim();
      const items = document.querySelectorAll("#productList li");
      items.forEach(item => {
        const barcode = item.getAttribute("data-barcode");
        // Barkod eşleşiyorsa göster, yoksa gizle
        if (barcode.includes(searchTerm) || item.textContent.toLowerCase().includes(searchTerm.toLowerCase())) {
          item.style.display = "";
        } else {
          item.style.display = "none";
        }
      });
    }

    function onScanSuccess(decodedText, decodedResult) {
      document.getElementById("result").innerText = decodedText;

      // Arama kutusuna yaz
      const searchBox = document.getElementById("searchBox");
      searchBox.value = decodedText;

      // Ürünleri filtrele
      filterProducts(decodedText);

      // İstersen taramayı durdurabilirsin:
      // html5QrcodeScanner.clear();
    }

    const html5QrcodeScanner = new Html5QrcodeScanner(
      "reader", { fps: 10, qrbox: 250 });
    html5QrcodeScanner.render(onScanSuccess);

    // Kullanıcı manuel arama yaparsa filtre uygula
    document.getElementById("searchBox").addEventListener("input", (e) => {
      filterProducts(e.target.value);
    });
  </script>
</body>
</html>